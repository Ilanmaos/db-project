{% extends "base.html" %}

{% block content %}
<h1>Bücher</h1>

<div class="container">
    <h2>Neues Buch erfassen</h2>
    <div class="form-box">
        <form action="/add_book" method="POST">
            <input type="text" name="buchtitel" placeholder="Buchtitel" required>
            <input type="text" name="autor" placeholder="Autor" required>
            <input type="text" name="verlag" placeholder="Verlag" required>
            <input type="text" name="sprache" placeholder="Sprache">
            <input type="number" step="0.01" name="originalpreis" placeholder="Originalpreis">
                <button type="submit">Buch speichern</button> 
                <!-- obere eingabe fur neues buch -->
        </form>
    </div>
    <form method="GET" action="/search">
        <input type="text" name="suche" placeholder="Buch suchen">
        <button type="submit">Suchen</button>
    </form>
    <h2>Alle verfügbaren Bücher</h2>
    <table>
        <thead>
            <tr>
                <!--<th>ID</th>-->
                <th>Buchtitel</th>
                <th>Autor</th>
                <th>Verlag</th>
                <th>Sprache</th>
                <th>Preis</th>
                <th>Aktionen</th>
                <!-- ubertitel bei ausgabe der bucher  -->
            </tr>
        </thead>
        <tbody>
            {% for buch in bucher %}
            <tr>
                <!--<td>{{ buch.id }}</td>-->
                <td>{{ buch.buchtitel }}</td>
                <td>{{ buch.autor }}</td>
                <td>{{ buch.verlag }}</td>
                <td>{{ buch.sprache }}</td>
                <td>{{ buch.originalpreis }}</td>
                <td>
                    <a href="/delete?book_id={{buch.id}}">Löschen</a>
                    <form action="/add_angebot" method="POST">
                        <input type="number" name="verkaufpreis" placeholder="Verkaufpreis" required>
                        <input hidden type="hidden" name="book_id" value="{{buch.id}}">
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div>
    <table>
        <thead>
            <tr>
                <th>Buchtitel</th>
                <th>Preis (€)</th>
                <th>Verkäufer</th>
                <th>Zustand</th>
            </tr>
        </thead>
        <tbody>
            {% for angebot in angebote %}
            <tr>
                <td>{{ angebot.buchtitel }}</td>
                <td>{{ "%.2f"|format(angebot.originalpreis) }}</td>
                <td>{{ angebot.username }}</td>
                <td>{{ angebot.qualitat }}</td>
            <td><a href="/accept?book_id={{angebot.buch_id}}&user_id={{angebot.user_id}}">Akzeptieren</a></td>
            </tr>
            {% else %}
            <tr>
                <td colspan="4">Momentan sind keine Angebote verfügbar.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}